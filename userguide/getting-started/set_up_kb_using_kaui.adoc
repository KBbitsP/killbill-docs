= Set Up Kill Bill Using Kaui
:imagesdir: C:\_My Documents\FlowWritingLLC\Projects\Kill Bill\Documentation\killbill-docs\userguide\assets\img\getting-started

//IMPORTANT: DELETE tutorial.adoc and remove its reference from install_kb_and_kaui.adoc. 

This section explains how to configure Kill Bill using Kaui, the back-office user interface.

As part of getting familiar with Kaui, we'll walk you through the steps of creating a tenant, setting up a simple catalog, followed by creating an account in Kaui. Next, you'll learn how to assign a payment method to the account and subscribe the account to a plan. Finally, you'll be able to view the generated invoice and payment.

[NOTE]
*Note:* You can also achieve these same results of this tutorial with the API. In fact, if you are going to have a front-end interface (such as a website), the API calls are what you use to communicate with Kill Bill (as opposed to using Kaui). For more information, see https://docs.killbill.io/latest/set-up-kb-with-the-api.html[Set Up Kill Bill with the API].

== Additional Resources

* https://docs.killbill.io/latest/install-kb-and-kaui.html[_Install Kill Bill and Kaui_]

* https://docs.killbill.io/latest/userguide_kaui.html[_Kaui Guide_]. 

* https://killbill.github.io/slate[_API Reference_]

* https://www.youtube.com/c/KillbillIoOSS[Kaui tutorials on YouTube]

== Before You Begin

Make sure you have installed Kill Bill and Kaui and launched them per the https://docs.killbill.io/latest/install-kb-and-kaui.html[_Install Kill Bill and Kaui_] guide. 

== Step 1. Create a Tenant (First-Time Login)

Kill Bill supports multi-tenancy, where each tenant has its own data, configuration, and so forth. This section explains how to create a tenant the first time you log in to Kaui.

. The first time you log in, Kaui prompts you to create a tenant: 
+
image::AddNewTenant-Blank.png[width=450,align="center"]
+
. Fill in the fields:
+
* *Name* refers to the tenant name.
* For *API Key*, use `bob`, and for *API Secret*, use `lazar` in the rest of this guide.
+
. Click the *Save* button. 

After you create a tenant, the active tenant name appears in the upper right corner of the Kaui screen:

image::select-tenant-name.png[width=850,align="center"]

== Step 2. Create a Simple Catalog with Two Plans

The Kill Bill *catalog* contains products and plans definitions. This XML configuration file is really powerful and offers various options for handling trials, add-ons, upgrades/downgrades, and so forth. For more details on its features, read http://docs.killbill.io/latest/userguide_subscription.html[_Subscription Billing_].

For this tutorial, instead of starting with the XML catalog, you'll learn how to create a simple catalog in Kaui and configure it with two plans. Note that this is _a subset_ of what is supported through XML configuration and isn't necessarily intended to serve as a catalog in production. For more details on the simple catalog, see the https://killbill.github.io/slate/#catalog-simple-plan["Simple Plan"] section in the _API Reference_.

To create the simple catalog and two plans: 

. Click the tenant name in the upper right corner: 
+
image::select-tenant-name.png[width=850,align="center"]
+
Kaui opens the Tenant Configuration page. 
+
. Scroll to the bottom:  
+
image::tenant-config-labeled.png[width=850,align="center"]
+
. Click the plus sign next to Existing Plans.
+
image::add-simple-catalog.png[width=250,align="center"]
+
Kaui opens the Catalog Configuration screen. 
+
. Fill in the fields as shown below: 
+
image::catalog-standard-free.png[width=450,align="center"]
+
. Click the *Save* button. 
+
Kaui returns to the Tenant Configuration screen. 
+
. Click the plus sign again. 
+
. On the Catalog Configuration screen, fill in the fields as shown below:
+
image::catalog-standard-monthly.png[width=450,align="center"]
+
. Click the *Save* button. 
+
Kaui returns to the Tenant Configuration screen. 
+
You will now see the two plans you have created. Note that when you created the first plan, Kaui created the simple catalog:
+
image::simple-catalog-two-plans-labeled.png[width=850,align="center"]

== Step 3. Create the First Account

In this section, we will create a customer account, which stores the data your organization deems necessary for transacting with a customer. To keep things simple, we will create an account with a minimum of information.

. At the top of any Kaui screen, click *Create New Account.*
+
Kaui opens the Add New Account screen.
+ 
. Fill in *Name* field as shown:
+
image::create-new-account.png[width=450,align="center"]
+
. Scroll down the page and click the *Save* button. 
+
Kaui displays the customer name for the new account at the top left of the screen:
+
image::account-name-labeled.png[width=450,align="center"]  

== Step 4. Add the First Payment Method

To pay any invoices, an account must have at least one payment method saved. This section explains how to add a payment method to a customer account. Again, for the sake of simplicity, we will keep it simple and create an offline payment method - checks - for the account we created in the previous section.  

. Search for and open the customer account. (If you still have the account open from the previous section, you can skip this step.) 
.. On the main Kaui page, click in the center text box and press the Enter key (or click the search icon).
+
image::ShowSearchHomepage.png[width=650,align="center"]
+
Kaui displays the accounts you have created so far for the tenant. 
+
.. Click on an account, which opens the Account page for the customer. 
. On the lower right, click the *+* sign next to *Payment Methods*. 
+ 
Kaui opens the Add New Payment Method screen:
+
. Verify the *Plugin name* field has the text `\\__EXTERNAL_PAYMENT__` and check the *Default payment method* checkbox. 
+
image::add-new-payment-method-cropped.png[width=450,align="center"]
+
. Click the *Save* button.
+ 
Kaui displays the new __EXTERNAL_PAYMENT__ in the *Payment Method* section. The filled star to its left indicates it is the _default_ payment method: 
+
image::payment-method-with-default-selected.png[width=350,align="center"] 

== Step 5. Create Your First Subscription

Now that you have created a plan (Step 2) and a customer account (Step 3), you can create a subscription to the plan for the customer. 

. Open the customer *Account* screen. 
. Click *Subscriptions* on the sub-menu. 
+ 
image::subscription-blank.png[width=850,align="center"]
+
. Next to *Subscription Bundles*, select the plus icon ( + ).
+
[NOTE]
*Note: A subscription bundle is a collection, a _bundle_, of subscriptions, containing one base subscription and zero or more add-ons.
+
. In the *Plan* field, select *standard-monthly*. 
+
image::add-new-subscription-labeled.png[width=450,align="center"]
+
. Click *Save*.
. The new subscription displays on the Subscriptions page: 
+  
image:subscription-created.png[width=850,align="center"]
+
Because there is no trial period and because billing is performed in advance by default, Kill Bill automatically generates the customer's invoice for the first month of the subscription. 
+
Click *Invoices* on the sub-menu to see it: 
+
image::invoices.png[width=850,align="center"]

-- SOMETHING I'm not clear on is if __EXTERNAL_PAYMENT__ is supposed to pay off the invoice immediately like "real" payment method? 

You should see the invoice and the payment by clicking on the Invoices and Payments tabs.

Kill Bill will now automatically charge the user on a monthly basis. You can estimate the amount which will be billed at a future date by triggering a dry-run invoice. On the main account page, in the Billing Info section, click the *Trigger invoice generation* wand (specify a date at least a month in the future).

== Step 6. View the Generated Invoice and Payment
