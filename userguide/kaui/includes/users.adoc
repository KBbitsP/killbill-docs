:imagesdir: C:\_My Documents\FlowWritingLLC\Projects\Kill Bill\Documentation\killbill-docs\userguide\assets\img\kaui

//Formal location - https://github.com/killbill/killbill-docs/raw/v3/userguide/assets/img/kaui

// /admin_allowed_users

//Mary's directory - C:\_My Documents\FlowWritingLLC\Projects\Kill Bill\Documentation\killbill-docs\userguide\assets\img\kaui

This section explains how to manage users in Kaui, which includes:

* Creating and editing new users
* Assigning roles and tenants to users
* Adding new user roles

This section assumes that you can log in as a Kaui admin or as a user with the correct permissions for working with users, roles, and permissions.

For additional information on managing users, roles, and permissions in Kill Bill, see the following:

* https://docs.killbill.io/latest/user_management.html[Users, Roles, and Permissions Management]

* https://killbill.io/blog/multi-tenancy-authorization/[Multi-Tenancy and Authorization]

* https://github.com/killbill/killbill-api/blob/master/src/main/java/org/killbill/billing/security/Permission.java[List of user permissions]

== Overview

In this guide, "users" refers to those who log in to Kaui to perform actions (add a charge, generate a dry-run invoice, etc.). However, user is referred to in other parts of the Kill Bill documentation to refer to users of the API.

In order for users to be able to log in and perform tasks in Kaui, you need to create a user profile for each one.

=== Managing Users with a Third-Party System

If you are managing users with a third-party system, all that's required in Kaui is to add the username per the <<Add a User>> section.

=== Managing Users with Kill Bill

If you are managing users with Kill Bill database _or_ solely with the `shiro.ini` file, first define the users and roles as described in https://docs.killbill.io/latest/user_management.html[Users, Roles, and Permissions Management]. Then, in Kaui, you must create the same users, passwords, etc. For more information, see <<Add a User>> and <<Edit a User>>.

// ADD "Permissions" and "User Role" to Glossary
// Permissions - A list of operations that can be performed in the system.

=== Users and Tenant Access

FIGURE THIS OUT:
See Tenants and Admin section?

If users are configured in a third-party system, the admin must associate each Kill Bill user's profile with the appropriate tenants.

Kaui needs to be told about the relationship between user and tenants (this mapping is specific to the UI). The idea, is that a super admin would first configure the allowed users for each specific tenant on the KAUI side, in such a way that later on, when a specific user logs in, he only sees the tenants he has access to.

This mapping can be configured by going to each user page (e.g. /admin_allowed_users/1).

QSTS:
- How do I get access to the screen that lets you map users to tenants
- Where can I see a list of existing user roles for the tenant <-- CAN'T DO THIS
- As mary@kill-bill.org user, do I need more permissions to see the gears icon at the top of the screen? Or can I access with those specific URL addresses (like /admin_allowed_users/1)?
- Can you delete users from Kaui, or do you have to remove them on the Kill Bill side (or in the 3rd party system)?

== Before You Begin

If your organization uses a third-party system (such as LDAP, Okta, or Auth0) to manage Kill Bill users and roles, you must first configure them in the third-party system _before_ before adding them in Kaui. For more information, see https://docs.killbill.io/latest/user_management.html[Users, Roles, and Permissions Management].

If you are using the Kill Bill database to store user data, adding a user profile to in Kaui automatically creates it in Kill Bill. **NOT SURE

== Create a New User Role

The role(s) assigned to a user define what tasks the user can perform in the system (for example, perform a chargeback or add a custom field).

. Open the Add New Role Definition screen, either from the User Update screen (see <<Edit a User>>) or by accessing `https://demo.killbill.io/role_definitions/new`.
+
image::AddNewRole.png[width=450,align="center"]
+
. Enter the *Role name* for the user. Do not use any spaces in the role name.
. Enter all the *Permissions* that are associated with this role. See the https://github.com/killbill/killbill-api/blob/master/src/main/java/org/killbill/billing/security/Permission.java[list of Kill Bill user permissions] as a reference.
. Click the *Save* button.

=== Add a User

. On the homepage, click the gears icon at the top of the screen.
+
image::Homepage-SettingsDropdown.png[width=650,align="center"]
+
. Select *Users.*
+
Kaui displays [SOMETHING]. _I don't have access to this screen._
+
. Select [SOMETHING ELSE].
+
Kaui displays the Add New User pop-up:
+
image::AddNewUser.png[width=450,align="center"]
+
[NOTE]
*Note:* You can also open the Add New User screen by clicking on the username and tenant name in the upper right corner and clicking the plus icon ( image:i_PlusGreen.png[] ) next to "Allowed Users."
+
. Fill in the fields. For field descriptions, see <<Add New User Field Descriptions>>.
. Click the *Save* button.

. CONFIGURE TENANT STEP HERE?

image::ConfiguredTenants.png[width=650,align="center"]
+
. Select the tenant(s) the user has access to.
. Click the *Save* button.

== Edit a User

Use the steps in this section to change the user's name, password, or role.

To edit a user:

. Click on your username and tenant name in the upper right corner: <--CAN ALSO GO TO SETTINGS->USERS, BUT I DON'T HAVE ACCESS
+
image::Users-SelectTenantName.png[width=650,align="center"]
+
. In the list of Allowed Users, click on the user to edit:
+
image::AllowedUsersList.png[width=650,align="center"]
+
^^SAME COMMENT AS ABOVE ABOUT NEEDING A SCREENSHOT WITH A LONGER USER LIST
+
Kaui displays the User Details screen.
+
image::UserDetails.png[width=450,align="center"]
+
. Click *Edit* (next to "User Details").
+
Kaui displays the Update User screen:
+
image::UpdateUser.png[width=450,align="center"]
+
. Fill in the user fields. For field descriptions, see <<Add New User Field Descriptions>>.
. Click the *Save* button.

== Add New User Field Descriptions

[cols="1,3"]
|===
^|Field ^|Description

| Managed externally (LDAP, Okta, etc.)?
| Check this box if you are managing users in a third-party system. Otherwise, leave it empty.

| Name
| Enter the user's name. _QST: Name should be first, last, both? Is email address here optional?_

| Password
| Enter the user's password. For security, Kaui does not display any existing passwords in this field, but you can type in a different one. It may be easier to copy and paste the password into this field.

| Description
| To provide a brief description of this user or his/her role on the Allowed Users list, type it here.

| Roles
| Enter the roles that are associated with this user. You also have the option to <<Create a New Role, create a new role>>.

|===

== Delete a User

_Can you delete a user on the Kaui side?_
