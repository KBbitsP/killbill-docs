:icons: font
:imagesdir: C:\_My Documents\FlowWritingLLC\Projects\Kill Bill\Documentation\killbill-docs\userguide\assets\img\kaui

=== Overview

Kaui lets you configure basic settings for how the system behaves when an account is overdue. In Kaui, this is a subset of the full overdue configuration settings and is defined at the tenant level. For more information, see the https://docs.killbill.io/latest/overdue.html[_Overdue System Guide_].

[NOTE]
*Note:* You can also configure overdue actions for the _global_ Kill Bill system (as opposed to configuring at the tenant level). For more information, see the https://docs.killbill.io/latest/overdue.html[_Overdue System_] documentation.

See the following sections to configure overdue (dunning) flows for a tenant:

[cols="1,1"]
[frame=none]
[grid=none]
|===

a| * <<View Overdue Configuration,View overdue configuration>>
* <<Configure Overdue Flows,Configure overdue flows>>
* <<Upload an XML Overdue Configuration File,Upload an XML overdue configuration file>>

a| * <<View Overdue Configuration as XML,View overdue configuration as XML>>
* <<Delete Overdue Flows,Delete overdue flows>>

|===

You cannot edit a raw overdue configuration XML file in Kaui.

==== Additional Overdue Resources

* https://docs.killbill.io/latest/userguide_subscription.html#components-overdue["Overdue"] section in the _Subscription Guide_.
* https://docs.killbill.io/latest/overdue.html[_Overdue System Guide_]

=== View Overdue Configuration

If any overdue (dunning) actions are configured, you can see them on the Overdue Show tab at the bottom of the Tenant Configuration page. To get there:

. Click on your username and tenant name in the upper right corner:
+
image::Users-SelectTenantName.png[width=650,align="center"]
+
Kaui displays the Tenant Configuration page.
+
. Scroll down and click on the Overdue Show tab:
+
image::OverdueTab.png[width=850,align="center"]

=== Configure Overdue Flows


The following steps explain how to set up overdue flows (i.e., actions) for the tenant.

. <<View Overdue Configuration,Go to the Overdue Show tab>> on the Tenant Configuration page.
+
image::OverdueTab.png[width=850,align="center"]
+
. Click the plus sign ( image:i_PlusGreen.png[] ) next to *Existing Overdue Config*.
+
Kaui opens the Overdue Configuration screen:
+
image::OverdueConfig-Empty.png[width=850,align="center"]
+
. Click *+ New Overdue States*. Kaui opens the fields for editing:
+
image::OverdueConfig-BlankFields.png[width=850,align="center"]
+
. Fill in the fields for the current row. For field information, see the <<Overdue Configuration Field Descriptions>> table.
+
. To add another overdue configuration row, click *+ new overdue states*.
+
image::Overdue-Select-NewOverdueState.png[width=450,align="center"]
+
. When you are done adding configuration rows, click the *Save* button. Kaui displays the new row(s) on the Overdue Show tab:
+
I NEED A SCREENSHOT OF THIS

[NOTE]
*Note:* To edit an existing overdue state/action, on the Overdue Show tab, click the plus sign ( image:i_PlusGreen.png[] ) next to *Existing Overdue Config*. This opens the overdue configuration fields in edit mode.

=== Overdue Configuration Field Descriptions

[cols="1,3"]
|===
^|Field ^|Description

| Name
| The name assigned to the overdue flow.

| External Message
| Message text that other plugins, when listening for overdue events, can retrieve and display to the user. (_Optional_)

| Block Subscription Changes
| If set to `true`, the customer can make plan changes to the subscription in this overdue state. If set to `false`, the customer cannot make changes.

| Subscription Cancellation
a| Select the option that describes how Kill Bill behaves regarding a cancellation in this overdue state:

* `NONE`: The subscription is not cancelled. _Not sure this is right_

* `POLICY_NONE`: ??? _Maybe some to do with the default cancellation policy in the catalog? Not sure..._

* `POLICY_IMMEDIATE_POLICY`: Cancels the subscription immediately and applies a partial credit to the
account based on how much of the service has been consumed.

* `END_OF_TERM`: Cancels the subscription at the end of the billing period with no refund to
the customer (i.e., no proration).

| Days Since Earliest Unpaid Invoice
| Specifies how many days should pass after the last unpaid invoice before initiating this overdue flow.

| Tag Inclusion
a| Specifies that the overdue flow will occur if the account is tagged with one of the selected system (control) tags. To disregard tag inclusion for this overdue state, leave as the default `NONE` setting.

* `AUTO_PAY_OFF`
* `AUTO_INVOICING_OFF`
* `OVERDUE_ENFORCEMENT_OFF`
* `MANUAL_PAY`
* `TEST`
* `PARTNER`

For a description of system tags, see the https://docs.killbill.io/latest/userguide_subscription.html#components-tag["Tags"] section of the _Subscription Guide_.

| Tag Exclusion
| Specifies that the overdue flow will _not_ occur if the account is tagged with one of the selected system (control) tags. See tags information above.

| Number of Unpaid Invoices
| Specifies that the overdue flow will occur if the number of unpaid invoices equals or exceeds the specified value.

| Total Unpaid Invoice Balance
| Specifies that the overdue action will occur if the total unpaid invoice balance equals or exceeds the specified value.

|===

=== Upload an XML Overdue Configuration File

. <<View Overdue Configuration,Go to the Overdue Show tab>> on the Tenant Configuration page.
+
image::OverdueTab.png[width=850,align="center"]
+
. Click the plus sign ( image:i_PlusGreen.png[] ) next to *Existing Overdue Config*.
+
Kaui opens the Overdue Configuration screen:
+
image::OverdueConfig-Empty.png[width=850,align="center"]
+
. Click *Enable Advanced Configuration (Upload XML)*. Kaui displays an upload screen:
+
image::Overdue-AdvancedConfigUpload.png[width=450,align="center"]
+
. Click the *Choose File* button, locate the XML file, and select it.
+
Once you have selected the file, Kaui displays the filename next to the *Choose File* button.
+
image::Overdue-AdvancedConfigUpload-File.png[width=450,align="center"]
+
. Click the *Upload* button.
+
If the upload is successful, Kaui displays a confirmation message along with a list of plans on the Catalog Show tab:

=== View Overdue Configuration as XML

. <<View Overdue Configuration,Go to the Overdue Show tab>> on the Tenant Configuration page.
+
image::OverdueTab.png[width=850,align="center"]
+
. Click *View Overdue XML* to the right of the plus sign ( image:i_PlusGreen.png[] ).

NOT SURE WHAT HAPPENS HERE. IT DOESN'T WORK FOR ME - GOES TO MAIN HOMEPAGE SCREEN WITH NO ERROR MESSAGE

=== Delete Overdue Flows

. <<View Overdue Configuration,Go to the Overdue Show tab>> on the Tenant Configuration page.
+
image::OverdueTab.png[width=850,align="center"]
+
. Click the plus sign ( image:i_PlusGreen.png[] ) next to *Existing Overdue Config*.
+
Kaui opens the Overdue Configuration screen.
+
. Click the red X ( image:i_RedX.png[] ) to the right of every configuration row you want to delete.
+
image::Overdue-Select-Delete.png[width=850,align="center"]
+
. Click the *Save* button.
+
Kaui removes the overdue configuration row(s) from the Overdue Show tab and displays a successful deletion message.

THIS ALSO DOESN'T WORK FOR ME. I'M ASSUMING YOU GET A CONFIRMATION MESSAGE THAT THE DELETE WORKED.
