= Kaui User Guide - DRAFT, PARTIAL
© 2022 The Billing Project, LLC
:doctype: book
:revlevel: 1.0
:revdate: Jan 2022
:revremarks: first draft
:toc:
:toclevels: 3
:figure-caption!:
:icons: font
:imagesdir: https://github.com/killbill/killbill-docs/raw/v3/userguide/assets/img/kaui

//Formal location - https://github.com/killbill/killbill-docs/raw/v3/userguide/assets/img/kaui

//Mary's directory - C:\_My Documents\FlowWritingLLC\Projects\Kill Bill\Documentation\killbill-docs\userguide\assets\img\kaui

//DINAH'S IMAGES
//https://drive.google.com/drive/folders==/1gmtaGIc2d9MGrgRYPfrZRIAZO3UfnCU3

//Ruby30-x64
//Command to convert to PDF:
//Asciidoctor-pdf "C:/_My Documents/FlowWritingLLC/Projects/Kill Bill/Documentation/killbill-docs/userguide/kaui/Kaui_Guide_Draft.adoc"

//RESOURCES
//https://asciidoctor.org/
//https://github.com/asciidoctor/asciidoctor.org/blob/main/docs/asciidoc-writers-guide.adoc
//https://docs.asciidoctor.org/asciidoc/latest/syntax-quick-reference/
//https://github.com/asciidoctor/asciidoctor-pdf/tree/main#readme
//https://github.com/asciidoctor/asciidoctor-pdf/blob/main/docs/theming-guide.adoc#keys-extends

== How to Use This Guide

<<part_1_navigation_and_interface>> explains how to *navigate* in Kaui and its *basic interface features*.

<<part_2_accounts>> explains how to perform the basic tasks for administering *customer accounts*, such as creating accounts, invoices, and so forth. It’s appropriate for back office staff, such as those working in customer service, product management, and finance.

<<part_3_users_roles_permissions>> explains how to create and manage *users* as well as *users roles* and *permissions*. It’s appropriate for Kill Bill administrators and software developers.

Advanced features are covered in Parts 4 - 6:

* <<part_4_tags_and_custom_fields>>
* <<part_5_plugin_manager_and_analytics>>
* <<part_6_tenants_and_admin>>

The <<faqs>> are great for *basic questions* like, _How do I create an invoice?_

=== About Screenshots
The screenshots displayed in this guide may differ from what you see on your Kaui screen. That's because your user permissions control what features you can access (i.e., what you see on the screen).

If you have any questions about why your Kaui screen doesn't match what you see in this guide, ask your Kaui administrator.

== Other Learning Resources

=== Videos
We regularly add new overviews and tutorials to https://www.youtube.com/c/KillbillIoOSS[our YouTube videos], so check in from time to time.

[glossary]
=== Glossary

The terms listed below are used frequently in this guide. We've provided an abbreviated description below. For a full description, see the
https://docs.killbill.io/latest/Kill-Bill-Glossary.html[_Kill Bill Glossary_].

Account (a.k.a. customer account):: A record that contains details about the customer (name, address, etc.).

Child:: An account that is associated with a parent account.

External Key:: An alternative unique ID for an object.

Parent:: An account that contains one or more child accounts.

Payment Method:: A record of the details required for Kill Bill to trigger a payment.

Plan:: Define how much a customer pays for a product and the frequency of the payment.

Plugin:: Software that runs alongside Kill Bill in order to provide additional functionality.

Phase (a.k.a plan phase):: Time periods within a subscription during which certain rules apply.

Subscription:: A contract between you (the business) and a customer that associates an account with a plan and a specific start date.

Tag:: A property that can be added to an object (for example, an account or a subscription) for information purposes or to affect the behavior of the system.

Tenant:: The division or organization that is using Kill Bill as a group of users. Note that an organization can have more than one tenant, as Kill Bill supports multitenancy.

User:: A person who logs on to use Kaui.

== Part 1 - Navigation and Interface [[part_1_navigation_and_interface]]

=== What Is Kaui?
"Kaui" (KAUI) stands for Kill (Bill) Admin User Interface. This self-contained web application interacts with Kill Bill over HTTPS.

Backoffice staff (for example, Support or Finance) will find Kaui useful to process refunds, credits, chargebacks, and so forth. Kaui also enables the Kill Bill administrator to perform more advanced tasks, such as managing tags, deploying plugins, and configuring the tenant(s).

Other types of users who might find Kaui useful are developers (for testing), operations, and product managers.

[NOTE]
*Note:* For Developers: Kaui functionality is provided via a series of Ruby on Rails mountable engines. You can extend its functionality (for example, to provide a custom UI for your plugins) by mounting your own engine(s).

=== What You Can Do in Kaui

In Kaui, users can  perform basic tasks, such as:

* Create a customer account
* Generate a customer invoice
* Cancel a subscription

However, Kaui can also help advanced users perform tasks, for example:

* Adding a plugin to Kill Bill
* Managing Kill Bill users
* Creating tags or custom fields

These are just a handful of the tasks you can accomplish with Kaui. For a full list, see the _Table of Contents_ at the beginning of this guide.

=== Sign In and Sign Out [[log_in_and_log_out]]

To sign in to Kaui, type in your username and password, then select the *Sign In* button.

image::LoginScreen.png[width=650,align="center"]

If your organization uses more than one Kill Bill tenant, select the tenant from the dropdown and select the *Save* button:

image::ChooseTenant.png[width=650,align="center"]

[NOTE]
*Note:* Authentication is handled by Kill Bill. The method your organization uses to manage users is highly configurable. For information on managing users and permissions, see <<part_3_users_roles_permissions>>.

To log out of Kaui, select *SIGN OUT* in the upper right corner of the Kill Bill homepage:

image::SignOut-Labeled.png[width=650,align="center"]

=== Navigate
This section gets you familiar with the standard features of Kaui's user interface, such as:

* <<Homepage Layout>>
* <<Icons>>
* <<grids_tables>>
* <<Basic Search>>
* <<Advanced Search>>

==== Homepage Layout

The homepage is the screen that Kaui displays after you first log in.

image::Homepage-Labeled.png[width=650,align="center"]

1. <<Basic Search>>
2. <<Advanced Search>>
3. <<part_5_plugin_manager_and_analytics,Plugin Manager and Analytics>> _Not yet documented._
4. <<part_4_tags_and_custom_fields,Tags and Custom Fields>>  _Not yet documented._
5. <<part_3_users_roles_permissions,Users,>> <<part_6_tenants_and_admin,Tenants, and Admin>>  _Not yet documented._
6. Username / Tenant name and  <<log_in_and_log_out,Sign Out>>
7. Latest invoices, accounts, and payments (latest records created for this tenant)
8. This is Killian, the Kill Bill mascot!

==== Return to Homepage

From any screen in Kill Bill, you can return to the homepage by clicking the logo in the upper left corner:

image::killbill_logo_LARGER.png[width=200,align="center"]

==== Icons

[cols="^1,3"]
|===
^|Icon ^|Description

|image:i_PlusGreen.png[]
|Add&#8212;Indicates you can add an item, such as a payment method, credit, charge, etc.

|image:i_InvoiceGen.png[]
|Dry-run invoice&#8212;Appears on the Account page. Clicking it manually triggers a committed or dry-run invoice.

|image:i_DownArrow.png[]
|Expand&#8212;Expand a section or dropdown menu.

|image:i_UpArrow.png[]
|Collapse&#8212;Collapse a section.

|image:i_Tag.png[]
|Tags&#8212;_Admin-level feature:_ On the home page, click to access Tags, Tag Definitions, and Custom Fields.

_All users:_ In other locations in Kaui, click to select a tag to apply to the current object (for example, an account).

|image:i_Plug.png[]
|Kaui Package Manager&#8212;Appears at the top of the screen and gives you access to plugin specific screens. (Also known as Kill Bill Plugin Manager.)

|image:i_Addon.png[]
|Add-on&#8212;Appears on the Subscription screen and lets you add an add-on to the account's subscription.

|image:i_CreditCard.png[]
|Make a payment&#8212;Appears on the Invoice screen and lets you make a payment against the invoice.

|image:i_Gears.png[]
|Users, Tenants, & Admin&#8212;_Admin level feature:_ Appears at the top of the screen and gives you access to Users, Tenants, and Admin.

|image:i_Refresh.png[]
|Appears in the Payment Methods section of the Account page, clicking the Refresh icon triggers a refresh for each payment plugin installed in Kill Bill, for that account. When you refresh a payment method, Kill Bill retrieves the latest payment information from where it's stored (for example, from Stripe or another payment gateway).

*Note:* This icon does not display if the only payment method listed is `EXTERNAL_PAYMENT`.

|===

==== Grids/Tables [[grids_tables]]
Grids (also referred to as _tables_) appear throughout Kaui to keep lists organized:

image::GridSample.png[align="center"]

For very large grids, use the pagination controls to view different "pages:"

image::PaginationControls.png[80,500,align="center"]

[%unbreakable]
--
To sort columns on a grid, click the up/down arrow in that column's header:

image::ShowSortArrowsOnColumn.png[width=650,align="center"]
--

Kaui shows you which column is currently sorted by the purple arrow:

image::ShowSortByColumn.png[width=650,align="center"]

The direction of the arrow (up or down) indicates if the column is sorted in ascending or descending order.

If relevant, you can click a link in the grid to view that item's detail. For example, on the Invoices grid, click the link to open that specific invoice:

image::ClickToViewDetail.png[width=650,align="center"]

==== Basic Search

[TIP]
*Tip:* To view all accounts, place your cursor in the search field and press the Enter key.

To search for customer accounts, use the basic search. Basic search is available at the top of the screen no matter where you are in Kaui.

image::ShowTopSearch.png[width=650,align="center"]

[%unbreakable]
--
You can search for an account using the following criteria:

* Account ID
* External key
* Name
* Email address
--

Basic search is also available in the center of the *homepage*:

image::ShowSearchHomepage.png[width=650,align="center"]

==== Advanced Search

An advanced search can help you find account information as well as other types of objects in the system:

* Bundle
* Credit
* Custom field
* Invoice
* Invoice payment
* Payment
* Subscription
* Tag
* Tag definition
* Transaction

To perform an advanced search:

1. On the homepage, click *Advanced search:*

image::ShowAdvancedSearch.png[width=650,align="center"]

Kaui displays the Advanced Search pop-up:

image::AdvancedSearchPopup.png[width=450,align="center"]

[start=2]
. In the *Object type* field, select the object type you want to search for:

image::AdvSearch-ObjectTypeDropdown.png[width=450,align="center"]

[NOTE]
*Note:* For information on which fields are searched for each object type, see the table in the next section.

[start=3]
. In the *Search for* field, enter the identifier (ID) of the object you're searching for. (_Example:_ If you're searching for a specific invoice, type in the invoice number.)

[start=4]
. If you want Kaui to search and display the first record in the search results, click the *Fast search* checkbox.
. Click the *Search* button. Kaui displays the search results.

[TIP]
*Tip:* At the bottom of the Advanced Search pop-up, Kaui displays the search syntax. You can copy and paste this advanced search syntax into a basic search field. This is helpful if you frequently perform the same kinds of advanced searches. For example:

image::AdvancedSearchSyntax-Labeled.png[]

==== Searchable Fields by Object Type

[cols="1,3"]
|===
^|Object Type ^|Searchable Fields

|Account
|account ID, name, email, company name, external key

|Bundle
|account ID, bundle ID, external key

|Credit
|invoice item ID

|Custom field
|custom field ID, field name, field value, object type

|Invoice
|invoice number, invoice ID, account ID, currency

|Invoice payment
|payment ID

|Payment
|payment ID, external key

|Payment method
|payment method ID, external key

|Subscription
|subscription ID, external key

|Tag
|tag ID

|Tag definition
|tag fefinition ID

|Transaction
|transaction ID, external key

|===

//________________________________________________//

== Part 2 - Accounts [[part_2_accounts]]

This section helps you become familiar with customer accounts and the layout of the Account page.

The Account page provides information about a specific customer, such as email address, physical address, and so forth. It is also the central location for the customer's billing information, subscriptions, invoices, and payment methods.

To find a customer in the system, use <<Basic Search>> or <<Advanced Search>>. To open the customer account, click the customer ID in the search results.

The next section explains how the Account page is laid out. To skip this and see the task-based steps, go to <<Create an Account>>.

=== Account Page Layout

The Account page has the following sections:

1. Sub-menu
2. Account information
3. Billing info
4. Personal info
5. Payment methods

image::AccountPage_Labeled.png[]

*1. Account Sub-Menu*

The *Account* sub-menu organizes and provides access to different areas of the customer's account:

image::Account-Submenu.png[width=650,align="center"]

To see these areas, click the relevant item on the sub-menu. To return to the customer's Account page, click *Account* on the sub-menu.

*2. Account Information*

This section of the screen displays a summary of the customer's account information, such as their ID, currency, and time zone. To edit this information, click *Edit* next to Account Information.

Here you can perform the following tasks for the customer account:

* <<Edit an Account>>
* <<Link to Parent Account>>
* <<Add a Tag to an Account>>

*3. Personal Information*

This section of the screen displays the customer's personal contact information (read only).

By default, Personal Information details are hidden for GDPR Compliance and customer privacy. To see the information, click *Show/Hide Content*.

To edit this information, see the <<Edit an Account>> section.

*4. Billing Info* [[billing_info]]

Here you can perform the following tasks for the customer:

* <<Pay All Unpaid Invoices, Pay all unpaid invoices>>
* <<Add Credit to a Customer Account, Add a credit>>
* <<Create a Charge on an Account, Create a charge>>

***

You can also see a summary of billing information:

[cols="1,3"]
|===
^|Field ^|Description

|Account balance
|Amount of money due on the account, including any account credits.

|Account credit
|Amount of any money owed to the customer.

|Overdue status
|The status of the customer's account that indicates if they are overdue or up-to-date on their invoice payments.

*Note:* The account can have a negative account balance, but not be overdue. That's because overdue status depends on invoice due dates and how late payments are defined based on a company's business policy. For example, an invoice may not be overdue if a company allows a 15-day grace period (a.k.a. NET terms) to make a payment.

|Bill cycle day (BCD)
|The day of the month on which the system generates an invoice for this account. This field applies to accounts that are subscribed to monthly subscriptions (or a multiple of monthly, such as quarterly, annually, etc.). For more information, see the <<Account Field Descriptions>> table.

|Next invoice date
|The date on which the system generates the customer's next invoice.

|===

The *Trigger invoice generation* feature lets you generate an invoice, either as a test or in a committed state.

*5. Payment Methods*

This section of the Account page lets you:

* <<_add_payment_method,Add a payment method>>
* <<_set_a_payment_method_as_the_default,Set a payment method as default>>
* <<_delete_payment_method,Delete a payment method>>
* <<_applying_transactions_to_a_payment_method,Apply a transaction to a payment method (authorize, charge, credit, etc.)>>

For more information on payment methods, see the <<_payment_methods>> section.

=== Create an Account

1. At the top right of the screen, click *Create New Account*:

image::CreateNewAccount-Labeled.png[width=650,align="center"]

[start=2]
. Kaui opens the Add New Account screen:

image::AddNewAccount.png[width=450,align="center"]

[start=3]
. Fill in the fields. For field descriptions, see <<Account Field Descriptions>>.
. Click the *Save* button.

<<<
==== Account Field Descriptions

[cols="1,3"]
|===
^|Field ^|Description

|Name
|The customer's first and last name.

|First name length
|This field sets the length of the customer's first name. Kill Bill automatically calculates this number based on the location of the space between the first and last name. You can overwrite it with a different number, if necessary.

*Note:* This field is used if your organization needs to extract customers' first or last names for communication (invoices, emails, etc.). The field lets an organization accommodate variations of names used across the globe.

|External key
|An optional alternate ID for the account. Once this is saved for the customer, you cannot change it.

*Tip:* The external key feature is helpful if you integrate Kill Bill with another system, such as a CRM, and want to use that system's ID in Kill Bill (for identification, searching, and so forth). Once this is set and saved for the customer, you cannot change it.

|Email
|The main email address to use for communicating with the customer.

|Bill cycle day (BCD)
|For monthly or quarterly subscriptions, what day of the month the invoice is created. Once this is saved for the customer, you cannot change it.

*Note:* The system has three types of billing (date) alignment that affect the BCD: `ACCOUNT`, `SUBSCRIPTION`, and `BUNDLE`. For more information about the three billing alignment types, see https://docs.killbill.io/latest/catalog-examples.html[_Catalog Examples_] and
https://docs.killbill.io/latest/userguide_subscription.html#_billing_alignment_rules["Billing Alignment Rules"] in the __Subscription Guide__.

|Currency
|The currency that the customer uses to make purchases. Once this is saved for the customer, you cannot change it.

|Timezone
|The time zone in which the customer resides. Once this is saved for the customer, you cannot change it.

|Locale
|Indicates the language that Kaui uses to send communication to the customer (invoices, emails, etc.)  If your organizaton communicates with customers in a language that's different than the system's default language, it's important to select the appropriate locale for the customer. For more information, see the https://docs.killbill.io/latest/internationalization.html[_Internationalization_] manual.

|Address line 1 and Address line 2
|The street address where the customer resides.

|Zip code
|The zip code for the area in which the customer resides.

|Company
|If relevant, the company/organization the customer works for.

|City
|The city in which the customer resides.

|State
|The state in which the customer resides.

|Country
|The country in which the customer resides.

|Phone
|The customer's phone number.

|Notes
|Additional information about the account. These notes are not viewable by the customer.

|Migrated?
|This field is for informational purposes only. You can check this box if you have migrated this customer account into Kill Bill.

|Contact email addresses
|Additional addresses to which account-related emails will be sent. The email addresses listed here will receive the same emails as the main Email address. For more information, see <<_add_additional_contact_emails>>.

|===

=== Edit an Account

You can make changes to most of the account fields after it has been created.

[NOTE]
*Note:* You cannot change the following fields: Bill Cycle Day, Currency, External Key, and Time Zone.

1. Open the account on the Account page.
2. Next to Account Information, click *Edit*.

Kaui opens the Update Account screen:

image::Account_UpdateScreen.png[width=450,align="center"]

[start=3]
. Make changes to the fields. For field descriptions, see <<Account Field Descriptions>>.

[start=4]
. Click the *Save* button.

=== Add Additional Contact Emails
If a customer wants to receive email at more than one email address (which is the one defined in the *Email* field for the account), you can add more email addresses.

1. Open the account on the Account page.
2. In the Personal Information section, click the gray down arrow ( image:i_GrayDownArrow.png[] ) to expand the section.

image::PersonalInformation.png[width=450,align="center"]

[start=3]
. Click the plus sign ( image:i_PlusGreen.png[] ) next to *Contact emails*.

Kaui opens the Add New Email screen:

image::AddNewEmail.png[width=450,align="center"]

[start=4]
. Type in a single email address.
. Select the *Save* button. Kaui returns to the Account page.
. To see the email address you added, expand the Personal Information section:

image::NewContactEmail.png[width=450,align="center"]

[start=7]
. To add another email address, repeat steps 2 - 5.

==== Delete Additional Contact Emails
[WARNING]
*Warning:* Kaui does not ask you to confirm your deletion; use this feature with caution.

To remove additional contact emails:

1. Open the account on the Account page.
2. In the Personal Information section, click the gray down arrow ( image:i_GrayDownArrow.png[] ) to expand the section.
3. Next to the email you want to delete, click the red X ( image:i_RedX.png[] ). Kaui immediately deletes the email address.

=== Close an Account
Use the steps in this section to indicate you will no longer be doing business with a customer. If the customer has unpaid invoices, using the steps below, you can choose to either write off or item-adjust them.

[NOTE]
*Note:* Closing an account does not delete it. It only indicates the account is no longer a customer of yours. Once you close the account, its data becomes read-only, and you cannot make changes to it.

1. Open the account on the Account page.
2. Next to Account Information, click *Close*.

Kaui displays the Close Account pop-up:

image::CloseAccountPopup.png[width=450,align="center"]

[start=3]
. Check the *Name* and *Account ID* fields to ensure you are closing the correct account.
. Toggle any of the following options:
* *Cancel All Subscriptions*&#8212;Stops any subscriptions that are current for this account.
* *Write Off Unpaid Invoices*&#8212;Brings the balance for all unpaid invoices to zero. When you choose to write off the invoice, it is removed from Account Receivables.
* *Item Adjust Unpaid Invoices*&#8212;Adds an invoice line item with a negative amount to bring each unpaid invoice's balance to zero.

[NOTE]
*Note:* The last two options are mutually exclusive (i.e., you can only select one of them).

[start=5]
. Click the *Close* button.

Kaui displays a message that lets you know the account was closed. In addition, the *Account* sub-menu displays "Closed:"

image::AccountSubmenu-Closed.png[width=650,align="center"]

=== Add a Tag to an Account

A "tag" is a way to attach specific information to an account (_Example:_ `good_user`) or a specify a certain behavior (_Example:_ `AUTO_INVOICING_OFF`). Kill Bill includes two types of tags:

* *System tags:* Written in ALL CAPS characters, system tags can affect the behavior of the system.
* *User tags:* Written in all lowercase characters, user tags do not affect the object they're attached to. User tabs are for informational purposes only.

For more information on Tags, including a list of default tags, see the https://killbill.github.io/slate/#account-tags["Tag" section] in the https://killbill.github.io/slate/[_REST API Reference Manual_].

To add a tag to a customer account:

1. Open the account on the Account page.
2. In the Account Information section, click the tag icon in the upper left corner:

image::AccountInfo-Section-Labeled.png[width=450,align="center"]

[start=3]
. Select the checkboxes of the tags you want to assign to the account.

image::Account-TagDropdown.png[width=450,align="center"]

[start=4]
. Click the *Update* button to save your changes.

<<<
=== Link to Parent Account

When you link an account to a _parent_ account, the account becomes a _child_ account. Defining a parent-child association between accounts lets you define which entity is responsible for paying the invoice. For more information on this feature, see the https://docs.killbill.io/latest/ha.html[_Hierarchical Accounts Tutorial_].

1. As a preparation step, open the parent account and copy the account ID in the Account Information section.
2. Open the account that will become the child account.
3. In the Account Information section of the child account, click the plus sign icon (image:i_PlusGreen.png[]) next to the *Parent* field:

image::Account-ParentField-Labeled.png[width=450,align="center"]

Kaui opens a pop-up:

image::LinkToParentPopup.png[width=450,align="center"]

[start=4]
. Click in the *Parent account id* field and paste in the account ID that you copied in step 1.
. To set the parent as responsible for all payments associated with this account, check the *Is payment delegated to a parent?* box. If you do not check this box, the child account is responsible for its own payments.

[start=6]
. Click the *Save* button. Kaui displays the parent account ID as a link in the Account Information section.

image::Account-ParentID-Labeled.png[width=450,align="center"]

You can open the parent account by clicking the account ID link.

==== Add Credit to an Account

Issuing a credit in Kaui creates a credit memo. For accounting purposes, the memo is saved with the customer account's invoices.

1. On the Account page, click *Add Credit* at the top of the Billing Info section.

image::AddCredit-Labeled.png[width=450,align="center"]

Kaui opens the *Add New Credit* screen:

image::AddCreditPopup.png[width=450,align="center"]

[start=2]
. Fill in the fields:

* *Amount*—The amount of the credit.
* *Currency*—The currency defaults from the customer account and should not need to be changed.
* *Reason*—The reason is automatically selected based on https://docs.killbill.io/latest/userguide_configuration.html#_kaui_configuration[Kaui configuration settings]. However, you can make a different selection.
* *Comment*—The text you enter here displays on the <<Timeline>> page after saving the credit. Adding comments is optional.

[start=3]
. Click the *Save* button. To view the credit, select *Invoices* on the sub-menu.

On the Account page (in the Billing Info section), Kaui adjusts the account balance and account credit accordingly.

==== Create a Charge on an Account

Creating a charge in Kaui creates a new invoice. To create a charge:

1. On the Account page, click *Create Charge* at the top of the Billing Info section.

image::CreateCharge-Labeled.png[width=450,align="center"]

Kaui opens the *Add New Charge* screen:

image::AddNewChargePopup.png[width=450,align="center"]

[start=2]
. To set the invoice as a draft instead of immediately committing it, uncheck the *Auto-commit* box.
. Fill in the fields:

* *Amount*—The amount of the charge.
* *Currency*—The currency defaults from the customer account and should not need to be changed.
* *Description* and *Comment*—What you type here displays on the customer's invoice. Both fields are optional.

[start=4]
. Click *Save* and Kaui generates an invoice.
. If you unchecked the *Auto-commit* box and have changed your mind, you can click the text *Commit* at the top of the page.

If you do not commit the invoice, it will stay in Draft mode. You can commit it by opening it from the Invoices page and clicking *Commit*.

On the Account page (in the Billing Info section), Kaui adjusts the account balance to reflect the amount of the charge.

=== Payment Methods

A customer account can have several payment methods to allow for making payments in different ways, such as credit cards, debit cards, PayPal, and so forth. The payment method includes the details needed for Kill Bill to process a payment against an invoice.

Saving this information in Kaui makes it easier to accept payments from the customer because the customer or service staff don't need to repeatedly provide their payment method details.

In production systems, payment method information is typically added via gateway-specific data flows. However, developers can use the Payment Method section for testing purposes.

[NOTE]
*Note:*Although you can't edit a payment method, you can delete it.

[WARNING]
*Warning!* For PCI compliance, _do not_ enter any genuine payment information in these fields.

==== About Payment Plugin Names

Each payment method is associated with a payment plugin, a type of software that performs the backend processing for that specific payment method. The *Plugin name* field specifies the name of this payment plugin. (_Example:_ `killbill-stripe`).

The plugin name is typically mentioned in the plugin's `readme` file. For example, in the https://github.com/killbill/killbill-stripe-plugin#using-stripe-checkout[Stripe plugin `readme` file], the plugin name is specified in the command line.

==== View Payment Method Details

To view a payment method after it's created:

1. Open the account on the Account page.
2. In the *Payment Methods* area, click the gray down arrow ( image:i_GrayDownArrow.png[] ) next to the payment method.

Kaui expands the details for the payment method:

image::PaymentMethod-Expanded.png[width=450,align="center"]

==== Set a Payment Method as the Default

Kill Bill uses the default payment method to automatically pay invoices (whether that invoice is generated by the system or manually by a user).

To set a payment method as the default:

1. Open the account on the Account page.
2. In the Payment Methods section, click the star icon (image:i_StarClear.png[]) next to the relevant payment method:

image::PaymentMethodStar-Labeled.png[width=450,align="center"]

The filled star ( image:i_StarFilled.png[] ) indicates it's now the default payment method.

==== Add Payment Method

To add a payment method:

1. Open the account on the Account page.
2. Next to *Payment Methods*, click the plus sign:

image::PaymentMethods-PlusSign-Labeled.png[width=450,align="center"]

Kaui displays the Add New Payment Method screen:

image::AddPaymentMethodScreen.png[width=450,align="center"]

[start=3]
. Fill in the fields. For field descriptions, see <<Payment Method Field Descriptions>>.
. Click the *Save* button.

===== Payment Method Field Descriptions

[cols="1,3"]
|===
^|Field ^|Description

|External key
|An optional alternate ID for the payment method. Once this is saved for the customer, you cannot change it.

|Plugin name
|Type in the name of the plugin that is associated with this type of payment method.

Each payment method is associated with a payment plugin that does the backend processing related to the payment method. The *Plugin name* field specifies the name of the payment plugin associated with the payment method (_Example:_ `killbill-stripe`).

The Plugin name is typically mentioned in the plugin's `readme` file. For example, in the https://github.com/killbill/killbill-stripe-plugin#using-stripe-checkout[Stripe plugin `readme` file], the plugin name is specified in the command line.

|Card type
|The name of the credit or debit card.

|Card holder name
|The name that appears on the card.

|Expiration month Expiration year
|The month and year the card expires. Enter month as _mm_ and year as _yy_. (_Examples:_ `07` for the month of July and `23` for the year 2023.)

|Credit card number
|The credit card number, typed without dashes.

|Address 1, Address 2, City, ZIP code, State, Country
|The billing address associated with this card.

|Add property (Name/Value)
|Use the *Name/Value* fields to assign custom fields and values to the payment method.

*Note:* Custom fields are an advanced feature. For more information, see <<part_4_tags_and_custom_fields>>.

|Default payment method?
|Check the box to set this payment method as the default. Kill Bill uses the default payment method to automatically pay invoices (whether the invoice is generated by the system or manually by a user).

*Note:* If you forget to select this box, you can set the payment method as the default by clicking the star icon next to the payment method on the Account page:

image:PaymentMethodStar-Labeled.png[width=350,align="center"]
|===



==== Applying Transactions to a Payment Method

This section explains how to apply a transaction to a payment method. These transactions are directly applied on the payment instrument (as opposed to being applied to the unpaid invoice).

Use this functionality only for transactions _unrelated to invoices and/or payments_.

_Example:_
After paying her final invoice, a customer cancels her subscription and demands a full refund because she is dissatisfied. In this case, you would process this transaction (the refund) against the payment method as explained in this section.

You can perform the following transactions from the Payment Methods section:

[cols="1,1"]
[frame=none]
[grid=none]
|===

a| * Authorize
* Capture
* Credit (see note)

a| * Purchase (i.e., charge)
* Refund
* Void

|===

[NOTE]
*Note:* "Credit" here refers to depositing funds directly to the customer card and is unrelated to account credits.

1. Open the account on the Account page.
2. In the *Payment Methods* area, click the gray down arrow ( image:i_GrayDownArrow.png[] ) next to the payment method.
3. Select the type of transaction you want to perform:

image::Payment_Method-Transactions.png[width=450,align="center"]

[NOTE]
*Note:* This area lists Authorize, Purchase, and Credit. For other transaction types, click any of these options. You will be able to change the transaction type on the next screen.

<<<
Kaui displays the Process Transaction screen:

image::ProcessTransaction.png[width=450,align="center"]

[start=4]
. Fill in the fields. For field descriptions, see <<Process Transaction Field Descriptions>>.
. Click the *Save* button. Kaui saves the transaction and displays it on the Payments page.

==== Process Transaction Field Descriptions

[cols="1,3"]
|===
^|Field ^|Description

|Transaction type
|From the dropdown list, select the type of transaction you want to perform.

|Amount
|The amount of the transaction.

|Currency
|The currency to use for the transaction. This field defaults from the customer account.

|Payment key
|The unique payment key (ID) to which you want to apply the transaction. This field is required for transaction types that are applied to a specific payment (Capture, Chargeback, Refund, Void).

*Note:* You can copy the payment key for a specific transaction from the *External Key* column of the Payments page. Or you can copy it from the URL displayed on your browser's address line:

 _Example:_

URL: `\https://demo.killbill.io/accounts/cb736a4f-9b56-4074-ae07-1d37b37cb69f/payments/0d1e11e5-2df6-4b6b-992f-e9ff2de38cef`

Payment key: `0d1e11e5-2df6-4b6b-992f-e9ff2de38cef`

|Transaction key
|Kill Bill automatically generates an external transaction key for Authorize, Purchase, and Credit transactions.
To process a transaction that requires the transaction key, open the payment detail from the Payments screen and copy the key from the *Transaction External Key* column.

image:TransactionKey-Labeled.png[width=350,align="center"]

|Reason
|The reason is automatically selected based on https://docs.killbill.io/latest/userguide_configuration.html#_kaui_configuration[Kaui configuration settings]. However, you can make a different selection.

|Comment
|The text you enter here displays on the <<Timeline>> page after the transaction is complete. Adding comments is optional.

|Add control plugin
|For information on control plugins, see <<part_4_tags_and_custom_fields>>.

|Add property (Name/Value)
|Use this area to assign custom fields and values to the transaction. For information on custom fields, see <<part_4_tags_and_custom_fields>>.

|===

==== Delete Payment Method

[WARNING]
*Warning:* Kaui does not ask you to confirm your deletion; use this feature with caution.

To delete a payment method:

1. Open the account on the Account page.
2. In the *Payment Methods* area, click the red X ( image:i_RedX.png[] ) next to the payment method. Kaui _immediately_ removes the payment method.

//________________________________________________//

=== Subscriptions

This section helps you get familiar with the Subscriptions area of Kill Bill.

For more information on subscriptions, see the https://docs.killbill.io/latest/userguide_subscription.html[_Subscription Guide_].

==== Open Subscriptions Page

To view the subscriptions for an account, open the account and click *Subscriptions* on the sub-menu.
This area of Kaui lists the subscriptions associated with an account.

image::Subscriptions.png[width=850,align="center"]

On the Subscriptions page, you can:

* <<Add a Subscription, Add a subscription>>
* <<Add an Add-On Product to a Subscription, Add an add-on product to a subscription>>
* <<Change a Subscription, Change a subscription's plan and amount>>
* <<Cancel a Subscription, Cancel a subscription>>
* <<Update the Billing Cycle Day, Update the billing cycle day (BCD) for the subscription>>

==== Add a Subscription

[NOTE]
*Note:* To create a subscription, you must have at least one product and one plan defined in the catalog. For information on adding plans to the catalog, see <<part_6_tenants_and_admin>>.

1. On the Subscriptions page, click the plus sign to the right of *Subscription Bundles:*

image::SelectAddSubscription.png[width=350,align="center"]

Kaui displays the Add New Subscription screen:

image::AddNewSubscription.png[width=450,align="center"]

[start=2]
. Fill in the fields. For field information, see <<Add Subscription Field Descriptions>>.
. Click the *Save* button.

==== Add Subscription Field Descriptions

[cols="1,3"]
|===
^|Field ^|Description

| Bundle Key
| If you leave this field blank, Kill Bill generates a unique bundle key. If necessary, you can enter a different bundle key.

|Subscription Key
| If you leave this field blank, Kill Bill generates a unique subscription key. If necessary, you can enter a different subscription key.

| Plan
| Select the plan from the dropdown list. These options come from the plans defined in the catalog.

| Price Override
| If you need to override the price for the plan you've selected, enter an amount in this field.

| Immediate Creation
| Select this option to start the subscription immediately.

| Specify a date
| To define a specific date on which the subscription begins, select this option, and choose a date from the *Date* field that appears.

|===

==== Add an Add-On Product to a Subscription

This section explains how to add an add-on product to a customer's subscription.

[NOTE]
*Note:* To add an add-on to a subscription, the add-on must exist in the catalog _and_ be available in the base plan. For information on adding an add-on to the catalog, see <<part_6_tenants_and_admin>>.

1. Open the account and click *Subscriptions* on the sub-menu.
2. Hover over the gift icon and click *Add add-on*:

image::Subscriptions-SelectAddOnIcon.png[width=350,align="center"]

Kaui opens the Add New Add-On screen:

image::AddNewAddOn.png[width=450,align="center"]

[start=3]
. Fill in the fields. For field information, see <<Add New Add-On Field Descriptions>>.

==== Add New Add-On Field Descriptions

[cols="1,3"]
|===
^|Field ^|Description

|Subscription Key
| Note that this subscription key applies to the add-on, not the original subscription. If you leave this field blank, Kill Bill generates a unique subscription key. If necessary, you can enter a different subscription key.

| Plan
| Select the add-on to add to the subscription.

| Price Override
| If you need to override the price for the add-on you've selected, enter an amount in this field.

| Immediate Creation
| Select this option to start the subscription immediately.

| Specify a date
| To define a specific date on which the subscription begins, select this option, and choose a date from the *Date* field that appears.

|===

==== Pause/Resume Subscriptions

Pausing and resuming happens at the subscription bundle level. In other words, pause/resume affects _all_ subscriptions and add-ons in the customer's account.

[NOTE]
*Note:* While a customer's subscription bundle is paused, you cannot add any new subscriptions or add-ons to the account.

You can use the pause/resume feature to:

* Stop a subscription bundle indefinitely
* Reactivate a paused subscription bundle
* Set a specific time period during which the bundle is paused and then automatically resumed

1. Open the account and click *Subscriptions* on the sub-menu.
2. Hover over the gift icon and click *Pause / Resume*:

image::Subscriptions-SelectPauseResume.png[width=350,align="center"]

Kaui opens the Pause/Resume screen:

image::Subscriptions-PauseResume.png[width=550,align="center"]

[start=3]
. Fill in the following fields:

* *Pause date*—The calendar date on which to temporarily stop the subscription bundle. To resume a paused subscription, leave this field blank.
* *Resume date*—The calendar date on which to remove the pause from the subscription(s). To set a pause to continue indefinitely, leave this field blank.
* *Comment*—The text you enter here displays on the <<Timeline>> page after saving the pause/resume. Adding comments is optional.

[start=4]
. Click the *Pause / Resume* button. Kaui displays a success message at the top of the screen.

==== Change a Subscription

In Kaui, you can change a customer's subscription from one plan to another plan. You can also define a different price than what is set in the catalog and when the change takes effect.

To change an account's subscription:

1. Open the account and click *Subscriptions* on the sub-menu.
2. In the *Actions* column (far right), click *Change*.

image::SelectChangeSubscription.png[width=250,align="center"]

Kaui opens the Change Subscription screen:

image::ChangeSubscription.png[width=450,align="center"]

[start=3]
. In the *New plan* field, select a different plan.
. If you need to override the price for the plan you've selected, enter the amount in the *Price Override* field.
. To accept the system's default policy for changing subscriptions (`END_OF_TERM`), leave *Default policy* selected and click *Save.*

OR

You can select one of two other options: *Specify Policy* or *Specify a date*. This will override the policy defined in the catalog for the plan. (For information on this topic, see see https://docs.killbill.io/latest/userguide_subscription.html#_plan_change_timing["Plan Change Timing"] in the _Subscription Guide_.)

* *Specify Policy*: You can select either `IMMEDIATE` or `END_OF_TERM`. For information on these two policies, see the https://docs.killbill.io/latest/userguide_subscription.html#_subscription_alignment_rules["Subscription Alignment Rules"] in the __Subscription Guide__.

image:ChangePlan-SpecifyPolicy.png[width=350,align="center"]

* *Specify a date*: Click on this and choose a date from the *Change Date* calendar that appears. Make sure to choose an effective date that is in the future.

image:ChangePlan-SpecifyDate.png[width=350,align="center"]

==== Cancel a Subscription

To cancel an account's subscription:

1. Open the account and click *Subscriptions* on the sub-menu.
2. In the *Actions* column (far right), click *Cancel*.

image::SelectCancelSubscription.png[width=250,align="center"]

Kaui displays several options. The option you select defines how Kill Bill handles billing for the canceled subscription:

image::Subscriptions-CancelOptions.png[width=350,align="center"]

===== Cancellation Options

[cols="1,3"]
|===
^|Option ^|Description

| Cancel (default policy)
| Uses the default policy specified for the plan in the catalog.

| Cancel start of term (full credit)
| Cancels the subscription immediately and refunds whatever amounts have been paid toward the subscription.

| Cancel immediately (partial credit)
| Cancels the subscription immediately and applies a partial credit to the account based on how much of the service has been consumed.

| Cancel end of term (no credit)
| Cancels the subscription at the end of the billing period with no refund to the customer. Note that after using this option to cancel, you can still reinstate the customer (i.e., reverse the cancellation).

| Cancel a subscription given a date
| If you select this option, Kaui displays a pop-up from which to choose a date:

image:CancelSubGivenDate.png[width=350,align="center"]

*Use requested date for billing*: To set the entitlement date and billing date the same as the date you just selected, check this box.

Otherwise, if you leave the checkbox empty, the entitlement date is the same as you just selected BUT the billing date defaults to _immediate_.

|===

==== Update the Billing Cycle Day

Follow the steps below to update the billing cycle day (BCD) defined for a subscription. These steps assume the subscription is billed on a monthly basis.

If you update the BCD with these steps, the new BCD overrides what is specified in the billing alignment rules in the catalog.

[NOTE]
*Note:* These steps do not change the account billing cycle day specified in the <<billing_info, Billing Info>> section on the Account page.

1. Open the account and click *Subscriptions* on the sub-menu.
2. In the *Actions* column (far right), click *Update BCD*.

image::SelectUpdateBCD.png[width=250,align="center"]

Kaui opens the Update Subscription BCD screen:

image::UpdateSubscriptionBCD.png[width=450,align="center"]

[start=3]
. In the *Billing Cycle Day* field, Kaui displays the currently defined BCD. Enter the number for the day of the month on which to bill.
. For this change to be effective immediately, leave the *Effective Date* field at its current setting. Otherwise, you can define a later date for this change to occur.

[NOTE]
*Note:* If *Effective Date* is the same as today's date, you will not see this change take place immediately.

[start=5]
. Click the *Save* button. On the Account page, the *Next Invoice Date* is adjusted to reflect the new BCD.


//________________________________________________//

=== Invoices

This section helps you become familiar with the Invoices and Invoice Details pages.

For more information on invoices, see the https://docs.killbill.io/latest/userguide_subscription.html#components-invoicing["Invoicing"] section of the _Subscription Guide_.

==== Invoices Page

The Invoices page lists the invoices for the currently selected account. To open the Invoices page, open the account and select *Invoices* on the sub-menu.

image::Invoices.png[width=850,align="center"]

Kill Bill generates invoices automatically based on the customer's subscriptions. However, you can manually create an invoice by <<_create_charge, creating a charge>> on the customer's account.

Click the invoice number to open the Invoice Details page.

==== Invoice Details Page

The Invoice Details page displays information about the invoice, such as the date it was generated, amount, and so forth.

image::Invoice_Detail.png[width=650,align="center"]

On the Invoice Details page, you can:

* Make a payment against an invoice
* Write off or void an invoice
* See the payment details (if the invoice was paid)

[NOTE]
*Note:* You can perform two other invoice-related tasks on the Accounts page: <<Generate a Dry-Run Invoice>> and <<Pay All Unpaid Invoices>>.

==== Open Invoice Details

To get to the Invoice Details page:

. Open an account.
. Click *Invoices* on the sub-menu.
. Select an invoice number.

[NOTE]
*Note:* To see any associated payment details, you may need to scroll down the page.

==== Make a Payment on an Invoice

To make a manual payment against an invoice:

1. <<Open Invoice Details, Open the Invoices Details page>> for the invoice.

image::Invoice_Detail.png[width=650,align="center"]

[start=2]
. Hover over the credit card icon and select *Make Payment*.

image::Invoice_MakePayment.png[width=350,align="center"]

[NOTE]
*Note:* If the invoice has already been fully paid, the credit card icon doesn't show, and the payment details are displayed below the invoice.

[start=2]
. Kaui displays the Process Payment screen:

image::Invoice_ProcessPayment.png[width=450,align="center"]

[start=3]
. Fill in the fields. For field descriptions, see <<Process Payment Field Descriptions>>.
. Click *Save*. The invoice detail shows the balance due on the invoice. Below the invoice, Kaui displays the payment details, including the status of the payment.

==== Process Payment Field Descriptions

[cols="1,3"]
|===
^|Field ^|Description

|External?
|Select this checkbox if the customer is making a payment outside of the Kill Bill system (such as with a check). Note that if this checkbox is selected, it overrides anything selected in the *Payment Method* field.

|Amount
|The amount defaults from the invoice balance. If the customer is making a partial payment, you can change this amount.

|Payment Method
|To use the account’s default payment method, leave the field blank. Otherwise, select the payment method from the drop-down.

|Reason
|The reason is automatically selected based on https://docs.killbill.io/latest/userguide_configuration.html#_kaui_configuration[Kaui configuration settings]. However, you can make a different selection.

|Comment
|The text you enter here displays on the <<Timeline>> page after the payment is complete. Adding comments is optional.

|===

==== Write Off or Void an Invoice

This section explains how to write off an invoice and void an invoice. "Write-off" and "void" have different meanings in Kill Bill:

* *Write off:* Brings the balance of an unpaid invoice to $0. This method is typically used when closing an account with unpaid invoices (or when you are sure the invoice is uncollectible). When you write off an invoice, Kaui applies the `WRITTEN_OFF` tag to the invoice. For more information on system tags, see the https://docs.killbill.io/latest/userguide_subscription.html#components-tag["Tags"] section in the _Subscription Guide_.

* *Void:* Changes the invoice's status to VOID, in which case it is ignored by the system. An invoice _cannot_ be voided if:

** It was partially or fully paid.
** It contains positive credit items.
** Any invoice item was internally adjusted by the system. (In this situation, you could refund the payment before voiding the invoice.)

===== Write Off an Invoice

To write off an invoice:

1. <<Open Invoice Details, Open the Invoices Details page>> for the invoice.

image::Invoice_Detail2.png[width=650,align="center"]

[start=2]
. Hover over the tag icon (image:i_Tag.png[]). Kaui displays a drop-down:

image::Invoice_WriteOffDropdown.png[width=350,align="center"]

[start=3]
. Select the *WRITTEN_OFF* checkbox and (optionally) type text in the *Comment* field.
. Click the *Update* button.

If the write-off is successful, Kaui displays "This invoice has been written off" at the top of the Invoice Detail.

===== Void an Invoice

To void an invoice:

1. <<Open Invoice Details, Open the Invoices Details page>> for the invoice.

image::Invoice_Detail3.png[width=650,align="center"]

[start=2]
. Hover over the trashcan icon ( image:i_trash.png[] ). Kaui displays a drop-down:

image::Invoice_VoidDropdown.png[width=350,align="center"]

[start=3]
. If desired, type text in the *Comment* field.
. Click the *Void* button.

If the void is successful, Kaui displays "This invoice has been voided" at the top of the Invoice Detail.

==== Pay All Unpaid Invoices

You can pay all unpaid invoices if a customer account has at least one outstanding invoice. Before you begin, make sure the customer has a valid payment method (see Note).

[NOTE]
*Note:* If the invoices have gone unpaid because of issues with the customer's payment method (for example, an expired credit card), make sure you <<Delete Payment Method, delete the old payment method>> and <<Add Payment Method, add  a new one>>.

To pay all invoices:

. Open the account on the Account page.
. In the *Billing Info* section, click *Pay all invoices*.

image::PayAllInvoices.png[width=350,align="center"]

If the payments are completed, Kaui displays a success message at the top of the screen. To see the payment details, click *Payments* on the sub-menu.

==== Generate a Dry-Run Invoice

A dry-run invoice lets you see how a customer's invoice will look without actually committing it. This feature creates a draft invoice as if it's being generated on the customer's bill cycle day. It's a helpful feature for testing. (You cannot generate a dry-run invoice for an invoice generated from a charge.)

After you generate the invoice, which is in `DRAFT` mode, you have the choice to commit it. If you do not commit the `DRAFT` invoice, it remains in the system as a draft.

In order to generate a dry-run invoice, the customer account must be associated with a subscription that has a billing date in the future.

. Open the account on the Account page.
. In the *Billing Info* section, make sure the *Dry-run* checkbox is selected.

image::Invoice-DryRunBox.png[width=450,align="center"]

[start=3]
. In the field next to *Dry-run*, enter the date that matches the invoice's upcoming invoice date.

image::Invoice-NextBillDate.png[width=450,align="center"]

[start=4]
. Click the magic wand button:

image::i_InvoiceGen.png[align="center"]

Kaui generates and displays the draft invoice. A message at the top indicates it is a draft invoice.

[NOTE]
*Note:* To change the invoice from `DRAFT` to `COMMITTED`, click "trigger an invoice run" in the message at the top of the invoice.

//________________________________________________//

=== Payments

This section helps you become familiar with the Payments and Payment Details pages.

For more information on payments, see:

* https://docs.killbill.io/latest/userguide_subscription.html#components-payment["Payment"] section of the _Subscription Guide_
* https://docs.killbill.io/latest/userguide_payment.html[_Payment Guide_]

==== Payments Page
The Payments page lists any payments applied to invoices for the customer account. This page also lists information about scheduled payment retries for failed payments.

To open the Payments page, open the account and select *Payments* on the sub-menu.

[NOTE]
*Note:* If a customer account has a default payment method, Kaui automatically makes a payment when an invoice is generated in the system. See <<About Automatic Invoice Payments>> for more information.

image::Payments.png[width=850,align="center"]

==== About Automatic Invoice Payments

Kill Bill automatically generates a payment for an invoice if an account:

* Has an outstanding, unpaid invoice
AND
* Has a default and valid payment method

Kill Bill _does not_ automatically generate an invoice payment if:

* No default payment method exists for the account
* The default payment method is invalid (e.g., expired credit card)
* The `AUTO_PAY_OFF` or `MANUAL_PAY` https://docs.killbill.io/latest/userguide_subscription.html#components-tag[system tags] are defined for the account

[NOTE]
*Note:* For invoices that Kill Bill does not automatically pay, you can use the "Pay all Invoices" feature. For more information, see <<Pay All Unpaid Invoices>>.

==== Payment Details Page

The Payment Details page displays information about a specific payment, such as the date it was generated,
amount, and so forth. Below the payment information is information about the payment method used.

image::PaymentDetails.png[width=850,align="center"]

On the Payment Details page, you can: <<Refund a Payment, refund a payment>> or <<Perform a Chargeback, perform a chargeback>>.

==== Open Payment Details

To get to the Payment Details page:

1. Open an account.
2. Click *Payments* on the sub-menu.
3. Select a payment number.

[NOTE]
*Note:* To see the associated payment method information, you may need to scroll down the page.

==== Refund a Payment

When you refund a payment from the Payment Details page, it brings the invoice amount to zero (i.e., the invoice will have no balance). You can also perform a partial refund in which the partial refund amount is added as an invoice line item. <--NOT SURE THIS IS RIGHT

The refund is applied to the same payment method used in the original payment.

[NOTE]
*Note:* You can also perform a refund directly on the payment method that was originally used. For more information, see <<Applying Transactions to a Payment Method>>.

To refund a payment:

1. <<Open Payment Details, Open the Payment Detail page>> for the payment.

image::PaymentDetails2.png[width=850,align="center"]

[start=2]
. Hover over the credit card icon and select *Refund*.

image::PaymentDetail-SelectRefund.png[width=350,align="center"]

Kaui opens the Process Refund screen.

image::ProcessRefundPopup.png[width=450,align="center"]

[start=3]
. Fill in the fields. For field descriptions, see <<Process Refund Field Descriptions>>.
. Click the *Save* button. Kaui saves the refund and displays it as a separate row on the Payments Details page:

image::PaymentDetails-Refund-Labeled.png[width=850,align="center"]

==== Process Refund Field Descriptions

[cols="2,4"]
|===
^|Field ^|Description

|No Invoice Adjustment

Invoice Item Adjustment

|If you are refunding the entire balance of the invoice, select *No Invoice Adjustment*. However, if you are providing a partial refund, select *Invoice Item Adjustment*. <--NOT SURE THIS IS RIGHT

|Amount
|The amount of the refund. Kaui automatically fills this in based on the invoice balance.

|Reason
|The refund reason is automatically selected based on https://docs.killbill.io/latest/userguide_configuration.html#_kaui_configuration[Kaui configuration settings]. However, you can make a different selection.

|Comment
|The text you enter here displays on the <<Timeline>> page after the payment is complete. Adding comments is optional.

|===

==== Perform a Chargeback

If your business receives a chargeback notice for a payment, you can record that chargeback in Kill Bill.

1. <<Open Payment Details, Open the Payment Detail page>> for the payment.

image::PaymentDetails3.png[width=850,align="center"]

[start=2]
. Hover over the credit card icon and select *Chargeback*.

image::PaymentDetail-SelectChargeback.png[width=350,align="center"]

Kaui opens the Process Chargeback screen with the *Amount* and *Reason* fields already filled in.

image::ProcessChargeback.png[width=450,align="center"]

[start=3]
. If necessary, select a different *Reason*. (The chargeback reason is automatically selected based on https://docs.killbill.io/latest/userguide_configuration.html#_kaui_configuration[Kaui configuration settings]. However, you can make a different selection.)
. If the subscription associated with the payment needs to be canceled, check the *Cancel account subscriptions* box.
. Fill in the *Comment* field (optional). The text you enter here displays on the <<Timeline>> page.
. Click the *Save* button. Kaui saves the chargeback and displays it as a separate row on the Payments Details page:

image::PaymentDetails-Chargeback-Labeled.png[width=850,align="center"]

=== Timeline

The Timeline displays a chronological list of events (that is, an audit log) that occurred for a specific customer account. You cannot make changes to the timeline.

To see the Timeline, open an account and click *Timeline* on the sub-menu:

image::TimelinePage.png[width=850,align="center"]

On the Timeline page, you can:

* _Filter the events_: Make selections in the *Filter by event* or *Filter by bundle* fields to display only specific events (e.g., `PURCHASE`, `INVOICE`) and/or by a specific subscription bundle.

image::Timeline-FilterFields.png[width=450,align="center"]

* _Sort rows_: Click the up/down arrows to the right of the column header to sort by the contents of that column. The blue arrow indicates which column's contents are currently sorted.

image::Timeline-SortByColumn.png[width=850,align="center"]

* _Open linked documents_: Click the document link in the *Details* column.

image::Timeline-OpenLinkedDoc.png[width=850,align="center"]


//________________________________________________//

== Part 3 - Users, Roles, and Permissions [[part_3_users_roles_permissions]]

*_IN PROCESS_*

//either database or third-party integration for storing usernames and passwords

//The default "admin" username/password includes all of the roles and permissions available with Kill Bill.

//________________________________________________//

== Part 4 - Tags and Custom Fields [[part_4_tags_and_custom_fields]]

*_IN PROCESS_*

// === Tags

// For the tags, it would make sense to touch on the 'system' tags versus user tags, the former (Uppercase) having a strong effect on the behavior of the system, while the latter (lowercase) having NO effect on the behavior of the system.

// === Custom Fields

//________________________________________________//

== Part 5 - Plugin Manager and Analytics  [[part_5_plugin_manager_and_analytics]]

*_IN PROCESS_*

// === KPM (Kill Bill Package Manager)

// === Analytics and Reporting

// === Deposits (Wire Transfers)

//________________________________________________//

== Part 6 - Tenants and Admin [[part_6_tenants_and_admin]]

*_IN PROCESS_*

Add a Catalog Item

This section explains how to add a base, add-on, or standalone product to the Kill Bill catalog.

. Click the tenant name in the upper right corner. Kaui displays the Tenant screen.

screenshot

. Scroll down to the Existing Plans section.
. Click the plug icon to the right of "Existing Plans." Kaui displays the Catalog Configuration screen.
. Fill in the fields. For field descriptions, see <<Catalog Field Descriptions>>.
. Click the Save button.


//________________________________________________//

== FAQs [[faqs]]

*_IN PROCESS_*

//I'm thinking this will get so long that it might be best to make it a separate manual?

// *Q:* What can I search on with Advanced Search?

// *A:* You can search on the following object types:

// * Accounts
// * Bundles
// * Credits
// * Custom fields
// * Invoices
// * Invoice payments
// * Payments
// * Subscriptions
// * Transactions
// * Tags
// * Tag Definitions
